{% extends "chatrooms/base.html" %}
{% load bootstrap5 %}
{% load static %}
{% block navbar %}
<nav class="navbar navbar-light bg-light sticky-top navbar-room">
    <div class="container-fluid d-flex justify-content-between">
        <div class="navbar-nav">
            <a class="nav-link" href="{% url 'chats' %}">< Back</a>
        </div>
        <div class="navbar-nav">
            <a class="nav-link" href="#">Other User</a>
        </div>
        <div class="navbar-nav">
            <a class="nav-link" href="{% url 'create_poll' room_id %}">Create a Poll</a>
        </div>
    </div>
</nav>
{% endblock %}
{% block content %}
<div class="container-fluid">
    <div id="chat-log">
        {% for chat in chats.all %}
        {% if chat.user.id == request.user.id %}
        <div class="message sender">
            <p class="message-text">{{ chat.content }}</p>
        </div>
        {% else %}
        <div class="message receiver">
            {% if is_group_chat %}
            <small class="username">{{ chat.user.username }}</small>
            {% endif %}
            <p class="message-text">{{ chat.content }}</p>
        </div>
        {% endif %}
        {% endfor %}
    </div>
</div>

<div class="footer">
    <div class="message-input">
        <textarea class="textInput expandable" id="chat-message-input" rows="1"></textarea>
        <button class="button" id="chat-message-submit" type="button">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-send-fill" viewBox="0 0 16 16">
                <path d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.18a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.002.26.41a.5.5 0 0 0 .886-.083l6-15Zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.154-.154l-.338-.215 7.494-7.494 1.178-.471-.47 1.178Z"/>
            </svg>
        </button>
    </div>
    {{ room_id|json_script:"room-uuid" }}
    {{ is_group_chat|json_script:"is-group-chat" }}
</div>

{{ request.user.id|json_script:"user_id" }}
{% endblock %}
{% block extrajs %}
<script src="{% static 'room.js' %}">
    var chatLog = document.getElementById('chat-log');
    chatLog.scrollTop = chatLog.scrollHeight;
</script>
{% endblock %}
